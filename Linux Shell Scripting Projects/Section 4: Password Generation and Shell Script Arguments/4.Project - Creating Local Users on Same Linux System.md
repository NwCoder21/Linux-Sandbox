# Project - Creating Local Users on Same Linux System

# Scenario 

![image](https://user-images.githubusercontent.com/107522496/210058965-87abbd79-270e-4178-b19c-2b1a3b19be75.png)

---

# Shell Script Requirements 

![image](https://user-images.githubusercontent.com/107522496/210059013-dffb5821-821a-4a38-b41a-e67156d467f8.png)
![image](https://user-images.githubusercontent.com/107522496/210059042-3cc73b2e-6094-42e2-b600-091f86707e8f.png)

---

The goal of this particular exercise is to create a shell script that adds users to the same Linux system as that shell script was executed on. This exercise actually builds upon the previous exercise, therefore, will be very similar to the previous exercise. We are going to make a few improvements.

---

One of the requests they have is that they're kind of tired of coming up with passwords every time they create an account, and they think you could automate that for them. So, we need to create a script which will generate a password for the account so that they don't have to do that.

---

Another thing with the previous (project) script was that when using that particular script, because they already knew all the information that they were going to provide the script, they still would have to wait to be prompted in order to type in that information.

They are thinking it will be more efficient if they could just type everything right in at the command line all at once and not wait to be prompted.

---

![image](https://user-images.githubusercontent.com/107522496/210060478-a0ceed94-013e-49b2-ad68-7258ffbcf79c.png)

To distinguish this script from the previous exercise script, we will be calling this script `add-new-local-user.sh` so they know that they are running the new script and not the old script.

---

# `#!/bin/bash` - Shebang 

![image](https://user-images.githubusercontent.com/107522496/210061299-06d57c01-a012-45f0-9685-220b56a156ad.png)

As always, start the script with the shebang (`#!/bin/bash`)

---

![image](https://user-images.githubusercontent.com/107522496/210061711-4e604dba-b251-4289-8ad2-baa356bf1e8d.png)

This is the mmain objective of the script and that the first thing on the command line after the script has to be a username. Anything that comes after the username will be considered a comment for the account.

Next, we're going to automatically generate a password. And finally, we're going to display that information.


---

# Making sure the script is being executed with superuser privileges.

We really don't want to do anything unless the user that's executing the script is doing it with proper permissions. There's no reason to try to add a user account when you don't have root permissions. So, let's make sure the user as the right permissions.

---

![image](https://user-images.githubusercontent.com/107522496/210062330-eb791daa-79d3-4939-8c20-673d641e1e5d.png)

So if the User ID is not equal to zero, then that means the user is not root.

---

# If the user doesn't supply at least one argument, then give them help.

![image](https://user-images.githubusercontent.com/107522496/210063365-09c1aca9-335c-413e-912c-94c88d127066.png)

Now, the next thing we want to do is make sure that they supply at least one argument. It's required that they give us a username. So, we will check for this next.

`${#}`: number of arguments.

If the number of arguments is less than 1, then a usage statement will be outputted showing the command they just entered and that a username is required. 

`${0}`: means the command the user just executed. 
`[COMMENT]`: we have put comment in brackets here because that's optional and there could be more than one comment or more than one word. To repeat that, we signify that by repeating three dots `...`.

`exit 1`: will exit with an exit status of 1 because this means the script did not complete. 

---

And now that we're sure that they have provided a username, we can go ahead and assign that username to a variable.

---

# Assigning the First Parameter as the USER_NAME

![image](https://user-images.githubusercontent.com/107522496/210063704-8b4245db-cc89-4c31-8034-8870f6fa4875.png)

`${1}`: is the first positional parameter.

---

# Assigning Remaining Parameters as Comments 

![image](https://user-images.githubusercontent.com/107522496/210063896-240ef62f-acc9-4b20-a7ac-a20428ad6487.png)

Now, we have learnt from our requirements and the help statement that we just wrote above, everything else on the command line will be considered as comments.


Since we've already assigned username to the value that was stored in the first positional parameter, `${1]`,  we no longer need `${1]`. So what we can do is use the `shift` command to shift everything down one position, meaning the original `${1]` will get dropped of and then what is left will be the comments.

`COMMENT="${@}"`: This means we can assign the variable `COMMENT` to everything else. `${@}` means every positional parameter starting at one and beyond. So, this captures everything that's left on the command line.

> REMEMBER: running `shift` took the user name out of the positional parameters, and then, what's left is going to be the comments.

---

# Generating a Password

![image](https://user-images.githubusercontent.com/107522496/210065353-f7a469f2-5f78-4caa-8a3d-dc773245ac13.png)

We will assign the password to the variable `PASSWORD`. You can use any name really.

By using `$(`, it means we are using command substitution. 

Here, to generate a password, we are using the code we learnt in the Random Data, Cryptographic Hash Functions, Text and String Manipulation lesson. 

---

Now we have all the information we need. We got the username from the command line. We also got the comments from the command line. We didn't ask for a password as we generated it on our own.

And so now we're ready to create the account.

---

# Creating the user with the password

![image](https://user-images.githubusercontent.com/107522496/210065643-01a23457-6c0b-45b1-bb68-27c7faf950a9.png)












---

# Code 

```bash
#!/bin/bash

# This script creates a new user on this local system.
# You must supply a username as an argument to the script.
# Optionally, you can also provide a comment for the account as an argument.
# A password will be automatically generated for the account.
# The username, password, and host for the account will be displayed. 


# Making sure the script is being executed with superuser privileges.
if [[ "${UID}" -ne 0 ]]
then
        echo "Please run with sudo or as root."
        exit 1
fi

# If the user doesn't supply at least one argument, then give them help
if [[ "${#}" -lt 1 ]]
then
        echo "Usage: ${0} USER_NAME [COMMENT]..."
        echo "Create an account on the local system with the name of USER_NAME and a comments field of COMMENT." 
        exit 1
fi

# The first parameter is the username 
USER_NAME="${1}"

# The remaining parameters on the command line will be for the account comments.
shift
COMMENT="${@}"

# Generate a password
PASSWORD=$(date +%s%N | sha256sum | head -c8)

# Create the user with the password
useradd -c "${COMMENT}" -m ${USER_NAME}

```






















































