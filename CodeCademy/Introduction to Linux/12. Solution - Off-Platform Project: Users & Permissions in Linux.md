# Solution - Off-Platform Project: Users & Permissions in Linux

In this article, you will practice some Linux system administration skills. You’ll make sure your coworkers James, Destiny, and Carolyn each have the intended levels of access to specific files.

Welcome to this off-platform project! You will follow along with the project in your Linux Ubuntu desktop (either in VirtualBox or native). Have your Linux terminal ready!

---

# Problem Statement

You are the system administrator of a small start-up. You need to manage access levels on a Linux computer. The following three users need to work with their specific files on the Linux computer:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/80cd3557-dd2d-4977-bade-8b54dc88b1ca)

* James is a member of the Marketing team who need full access to all the Marketing files.
* Destiny is a member of the Sales team who need full access to all the Sales files.
* Carolyn is an administrator who needs read access to all files of all departments to monitor security and compliance.

---

# Environment Setup

Step 1:

Access your Linux environment, whether it is through VirtualBox or Linux running natively on your desktop. Login to your Linux environment as root or run the following command to escalate your access levels to the root: 

```
sudo -i
```

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/fe506968-9e1b-49e9-bca6-518c7257f7b0)

Now I am root and at the root directory of the file system. 

---

Step 2: Start by creating the groups for the marketing team, sales team, and the information technology team. 

```bash
groupadd marketing-team -f
groupadd sales-team -f
groupadd it-team -f
```

Solution: 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/3489dfd3-b859-475c-8780-8c3adf4f2648)

First created the marketing team. Then used `cat /etc/group' to ensure group has been created:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/3a385b5a-3483-45b1-bff0-c363e9d38bbb)

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/d6e136b1-8ebf-4120-85a0-941996249a45)


> Note: thr `-f` option ensures group is created.

---

Step 3: Verify that the groups are created by listing all the available groups on your environment: 

```
cat /etc/group
```

The newly created group names must be appended at the end of the list.

Solution: 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/117cc092-f604-44ee-9f13-5e2487776f3b)

Can now see all three have been created.

---

Step 4: Then create the users.


```
useradd james -g marketing-team -m
useradd destiny -g sales-team -m
useradd carolyn -g it-team -m
adduser carolyn sudo
```

The users are promptly added to their proper groups using the `-g` option. In other words, the `-g` option is used with `useradd` to esnure that user also gets addedd to a specfic group. In addition, a new `home` directory is created for each new user since the `-m` flag is enabled. 

Solution:

First just added James.:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/4faeb303-9aa8-4a25-abd0-c1081d3dbf3a)

Then to check if he has been added, ran the `cat /etc/passwd` command:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/75980644-3aa5-442d-855d-344f96c27411)

Can now see he has been added. 


Then added the rest:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/ce28be14-54a3-43a8-bd8a-d9a9ed9ce215)

---

Also, because I want carolyn to have full access to the environment, we need rto add her to the `sudo` group too:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/afbae302-4033-4885-bbac-766aae00c9d6)

---

Step 5: Observe the newly created home directories for the users:

```
ls /home/
```

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/2496ddbd-4d5b-4d87-9364-effc28430c7e)

---

Step 6: Verify that the users are added to their proper groups by listing the groups for each user using the following command:

```
groups [username]
```

For example:

```
groups james
```

Solution: 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/ae94a7aa-39f2-49dc-a8d9-685d251b35fc)

---

Step 7: Next, create separate directories for each department. Download an archive of pre-created directories using wget. Alternatively, you can use curl to download the archive.

```
wget https://static-assets.codecademy.com/Courses/learn-linux/linux-shell-utilities/project-data.tar.gz
```

Or

```
curl https://static-assets.codecademy.com/Courses/learn-linux/linux-shell-utilities/project-data.tar.gz
```


Solution: 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/63b0d7ee-00ba-46b3-a23d-85f2d80eabf4)

Can now see the file has been downloaded below:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/bee02b2c-ac86-4a8f-a780-516fa00a82ee)

---

Step 8: Then extract the archive to create the data directory and the sub-directories for the departments.

```
tar -xzvf project-data.tar.gz -C /tmp/
```

The command extracts the tar ball and creates the directory structure in the `/tmp` directory, which is a temporary directory in Linux where contents are automatically wiped out every 10 days. The temporary directory serves the purpose of this off-platform project, however, user data will be stored in more permanent directories such as `/home` in real world scenarios. 


Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/8af2d772-8c30-4ed4-8760-46babd8bfcff)

---

Step 9: Verify the files and directories are created by visualizing the directory structure using the following command that relies on `sed`, a stream editor for filtering and transforming text:

```
find /tmp/data | sed -e "s/[^-][^\/]*\// |/g" -e "s/|\([^ ]\)/|-\1/"
```

Solution: 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/f72946c2-12ca-4161-be28-b0637fceb316)

Alternatively, you can use the `tree` utility if you have it installed on your operating system.

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/086bded0-cbb8-4889-b084-1d7b9b644499)

```
tree -d /tmp/data
```

The files structure looks like the following:

```
 |-data
 |     |-Sales
 |     |     |-file02
 |     |     |-file01
 |     |-IT
 |     |     |-file02
 |     |     |-file03
 |     |     |-file01
 |     |     |-file04
 |     |-Marketing
 |     |     |-file02
 |     |     |-file03
 |     |     |-file01
```

---

Step 10: Now we can modify the file permissions to reflect the requirements for each user and group. In other words, let's assign the owner for each directory. Starting with the Marketing department, set the owner of the `/tmp/data/Marketing`, the marketing group. 

```
chown :marketing-team /tmp/data/Marketing
```

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/1338d195-b1ec-47e5-b49f-88fd1e54c583)

---

Step 11: And repeat the same process for the other departments.

```
chown :sales-team /tmp/data/Sales
chown :it-team /tmp/data/IT
```

Solution: 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/59f55496-7451-499a-b63d-59f2b17ec5f1)

So, for example, the IT team will be the owner of the IT directory. 
 
---

We need to make sure that only the members of the group have full access to their directory:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/def9bbec-8ff7-4b13-bc58-b97fc2ec12b2)

Step 12: To ensure that the permission levels are adjusted for each directory, let's do the below

```
chmod -R 774 /tmp/data/Marketing
chmod -R 774 /tmp/data/Sales
chmod -R 774 /tmp/data/IT
```

Solution: 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/6f27fa27-1742-4baf-bd22-ac01d5cb2b9b)




---

Step 13: Now you should be able to verify the owner group for each directory if you list all directories in `/tmp/data`.

```
ls /tmp/data -l
```

Solution: 

Now let's run `ls /tmp/data -l` again:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/90e85f92-b9fc-442c-a1d2-d7cb627f0e9d)

Can see the permissions have been adjusted accordingly.

---

# Access Verification

Step 14: Impersonate another user and verify their level of access. Let’s start with James.

```
su james
```

Solution: 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/041191cb-4878-46ee-8c99-5bfd04682d8e)

Then let's see if James has access to the root directory:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/d0722e86-3056-412f-9c32-d65c2772fe69)

He does not as he is not root. 

---

Before doing step 15, first let's check if james is able to access the sales folder and then see if he can access the files within this folder:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/71940817-e21f-444c-8cb0-29569a3a8e64)

James has a read access to the directory to list the files but it's not able to open the specific files inside the sales department directory which is exactly what we want.

Now let's check if james has access to the `Marketing` directory, which he should be able to do so. 
 
Step 15: Now you are logged in as James and should have access to the `Marketing` directory.

```
ls /tmp/data/Marketing
```

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/ecb1d61f-be75-4e39-824a-fd0d26c9a096)

Can see he does have access to the `Marketing` directory.

---

Step 16: Read the data in one of the files.

```
cat /tmp/data/Marketing/marketing_plan.txt
```

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/415c2e50-279d-4be4-92a5-c11b6edce182)

Can see that james is able to also access files. 

---

Step 17: Try logging into Destiny’s and see if she can access `/tmp/data/Marketing/social_media_strategy.txt`. 

Can Destiny see the content of `/tmp/data/Sales/contract_template.txt`?

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/9adee346-6989-432e-942d-2ad798499f60)

First exit as james and then log in as destiny.

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/c0a47518-8826-4eff-a057-e8631e34aba0)

Can see she is not able to access the marketing_plan.txt file. This is what we want as she is not from the marketing team. 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/0366f90d-4318-48d2-b464-d77539424a39)

Can see that she is able to access the sales file. 
---

# Conclusion

We have reviewed commands to add users, set file permissions, and match the users to their correct level of access. 
















