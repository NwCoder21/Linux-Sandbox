# Solution to Project: Off-Platform Project: What's the Hottest City?

Use the weather utility from Bash-Snippets to gather and sort temperature data from multiple cities.

# Project Objectives

This project, which you’ll complete in a Linux environment, reviews the bash scripting skills you’ve learned thus far. You will be creating a bash script that:

* Fetches forecast temperatures for multiple cities.
* Saves those temperatures to a file.
* Sorts the cities based on their temperatures.

You will install and use a modified version of the `weather` bash script from [Bash-Snippets](https://github.com/alexanderepstein/Bash-Snippets) to gather the required forecast information. The `weather` script gets the location from the user and sends it to the [wttr.in](https://wttr.in/) API. The API returns a detailed weather forecast of the specified location.

---

# Project Setup

Even though the wttr.in API is highly customizable, the original `weather` script is not. This is why we made our own version of the `weather` command which can show a much simpler output such as: `Paris +39°F`.

---

# Install Modified weather Script

Let’s begin by opening up a terminal inside VirtualBox Ubuntu Desktop and:

Step 1: Download our modified `weather` script using the command

```
wget https://static-assets.codecademy.com/Courses/learn-linux/weather-offplatform-project/weather.sh  
```

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/e3cf4f9f-6b9c-4852-82f6-8c43dc983852)


When we run `ls`, we can see the `weather.sh` script has been downloaded.

---

Step 2:  Give it executable permissions using the command:
```
    chmod +x weather.sh
```

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/4a432dee-cd1e-4d7e-b54a-462cd12de409)


---

Step 3: See the usage of our script with:

```
./weather.sh -h
```

Solution: 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/ed8093b8-99ee-4437-b354-1289bf271153)

The `-h` option is for help.

---

Step 4: We retained the original functionality of the weather utility while adding an option, `-s`, to show a simpler output. Try out the script with and without the `-s` option. 

* With `-s` option:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/fce8c4fb-aef3-4148-89a1-e1dac7028be3)

* Without `-s` option

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/5bf4cfb3-b61a-4745-870a-1a3e3ee61a11)

---

Step 5: You could try some of the examples below:

* `./weather.sh Tokyo`

Solution: 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/0625f9c7-52dd-47a3-ba02-d4a906f0cd2d)

---

STep 6: `./weather.sh -s Tokyo`

Solution: 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/88980b7c-7dee-4fff-8264-571b4d279edf)

Notice the original output is quite fancy, which makes it challenging to filter out the temperature.

---

# Optional: Install Bash-Snippets `weather` Script

Installing the original `weather` script from Bash-Snippets is optional. However, it is recommended if you are familiar with git and if you wish to further improve on the script you will be writing in this project.

Step 7: To install the official weather script from Bash-Snippets. Enter the following commands one at a time on the terminal:

```
sudo apt -y install git
git clone https://github.com/alexanderepstein/Bash-Snippets
cd Bash-Snippets/
git checkout v1.23.0
sudo ./install.sh weather
```

Step 8: Once the `weather` script is installed, see its usage with `weather -h` and try it out!


Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/a8fa4d06-40ee-41fa-8144-c637d20c5525)

Can see from above that my machine has Git alread installed.

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/f840b105-387b-4de6-9927-e9695e9b70b4)


Step 9: Once complete, we can verify the installation by invoking the `-h` option:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/1c845d09-017b-40fa-85dc-44bd44100060)


---

To finish the set up process, we need to create a bash script which we will be working on. 

# Create Script File

Step 10: Let’s create the shell script file we will be working with, **sortCityTemps.sh**, and give it permission to execute:

```bash
touch sortCityTemps.sh
chmod +x sortCityTemps.sh
```

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/8a0ac9e8-c955-4fb0-a9f5-1c7f14c0b439)

---

You can work on this file in either the Ubuntu Desktop Editor (which comes pre-installed), a code editor of your choosing, or inside the terminal itself with `nano`. You can open the file in Ubuntu Desktop Editor using the command `gedit sortCityTemps.sh &`. If you decide to use `nano`, remember that you can save changes to the file using `CTRL` / `CMD` + `O` and exit using `CTRL` / `CMD` + `X`.

I will be using Vim. 

---

Step 11: Add the line `#!/bin/bash` to the top of the script and save!

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/d0384629-6b8a-4aa5-9bbc-43c05056b900)

---

# Collect and Sort Temperatures

Inside our script **sortCityTemps.sh**:

Step 12: Create an array of cities you will be getting the temperatures of. You can create an array in Bash using the format

```bash
cities=("City1" "City2" "City3")
```

Replace the values in the quotes with at least 3 of your favorite cities. For simplicity, let’s pick cities that don’t contain spaces in their names.

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/8a87cd19-95da-4309-936c-ac82fe1b4a60)

---

Step 13: In the script, create an empty file called **temperatures.txt** where you will be saving the temperatures. You can use output redirection `>` to accomplish this.

For example, the command `> movies.log` will create an empty file called **movies.log**. If this file already exists, the command will overwrite it. This makes sure there’s a fresh, blank version of this file each time the script is run.

Solution: 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/d5a75c0b-93d9-49b9-b6fe-fb1ee4b08226)

---

Step 14: Next, you need to set up a loop to iterate through the cities in the array you created. Using a `for` loop makes this an easy task:

```bash
for city in ${cities[@]}
    do
    # commands to repeat
    done
```

The `city` variable takes the value of item inside the array on each iteration of the loop. On the first iteration, for example, it will be assigned to “City1”. “City2” on the second iteration. “City3” on the third iteration and so on.

Solution

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/ede79bb8-f0e3-4513-8c96-6527b65e872e)

---

Step 15: Inside the loop, add the command `sleep 1`. This pauses the script for 1 second at every iteration to ensure you do not send too many requests to the API in a short amount of time.

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/30d7a795-625b-4536-8bf1-d89ee66c8b6e)

---

Step 16: Inside the loop, call our modified script **weather.sh** using the `city` variable as the parameter. Make sure to use the `-s` option to get the simplified weather output.

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/ff993f57-e3ae-46b3-bc6a-195d72a7cbf4)

We encourage you to run the script in-between steps for the sake of testing. Before continuing to the next step, try printing out the output from the **weather.sh** script using `echo`. Remember the simplified output looks like `Paris +39°F`.

Solution: 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/2b5a4d3f-ffe0-4422-b3a8-a3bec5c4ef91)

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/77c9ec6e-7d02-4734-bba4-38be5bec7ab6)

Looks like it  is working but we do not want symbols to be in our **temperatures.txt** file. It will make the sorting of the data more difficult.

---

Step 17: You need to remove the extra symbols like `+` and `°F` so the data is easily sortable. Pipe the output of the weather script into the `sed` command to replace these with an empty string. For example, `sed 's/+//'` removes the `+` symbol from the output.

You may need to pipe and use the `sed` command more than once.

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/613b8edc-251c-49af-86b3-c466da908837)

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/5308b983-e50d-4173-bff2-743513a559e3)

---

Step 18: Using output redirection `>>`, append the final weather output to a file called `temperatures.txt` (in the first iteration, since the file doesn’t exist yet, it will be automatically created. In the iterations after that, the temperatures will be appended).

Also, remove the `echo` command from the script.

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/74ef492d-a45e-4860-b93c-5e06447660eb)


After running the script at this point, **temperatures.txt** should contain something like this:

```bash
Paris 46
Tokyo 64
London 36
```

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/9aa9601f-3201-4a36-9357-aa3359a9cb1e)

---

Step 19: Finally, let’s sort the temperatures saved in the **temperatures.txt** file in descending order and save that sorted output to a final file.

In the script after the loop, use the `sort` command on the file containing our city temperatures. The `sort` command by default will sort according to the city name in ascending order. 

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/c2526cb0-7ce3-4133-9fe2-966d0789be61)

In the above, it is sorting according to the city name. 

But you want it to sort according to the temperatures in descending order! Use `sort` on **temperatures.txt** with the options `-k2` (to sort based on the second value in each line) and `-r` to sort in descending order.

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/cc2b95e4-6741-4dec-8c72-a215b57fa4f2)

Now let's add this line to our script. 

---


Step 20: Save the sorted output to a file called **sorted_temperatures.txt** using output redirection `>`.

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/b5c6c2e8-8f04-4b3a-bf40-3af783a3093e)

---

Step 21: Save and run `./sortCityTemps.sh`. Open the file **sorted_temperatures.txt** and see that the cities are now sorted according to their current temperatures.

Solution:

![image](https://github.com/NwCoder21/Linux-Sandbox/assets/107522496/28765796-ecca-4ccf-a5d6-6f6dd9410f22)

---


# Code:

```bash
#!/bin/bash

cities=("London" "Paris" "Tokoyo")
> temperatures.txt
for city in ${cities[@]}
    do
    # commands to repeat
    sleep 1
   ./weather.sh -s $city | sed 's/+//' | sed 's/°C//' >> temperatures.txt
done
sort -k2 -r temperatures.txt > sorted_temperatures.txt
```



























